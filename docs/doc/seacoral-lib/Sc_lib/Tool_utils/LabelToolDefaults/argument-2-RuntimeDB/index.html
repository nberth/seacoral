<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>RuntimeDB (seacoral-lib.Sc_lib.Tool_utils.LabelToolDefaults.RuntimeDB)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">seacoral-lib</a> &#x00BB; <a href="../../../index.html">Sc_lib</a> &#x00BB; <a href="../../index.html">Tool_utils</a> &#x00BB; <a href="../index.html">LabelToolDefaults</a> &#x00BB; RuntimeDB</nav><header class="odoc-preamble"><h1>Parameter <code><span>LabelToolDefaults.RuntimeDB</span></code></h1></header><div class="odoc-content"><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../../Tool/module-type-GenericInitializer/index.html">Tool.GenericInitializer</a></span></code></summary><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../../Tool/module-type-TomlSpec/index.html">Tool.TomlSpec</a></span></code></summary><div class="odoc-spec"><div class="spec type anchored" id="type-opt"><a href="#type-opt" class="anchor"></a><code><span><span class="keyword">type</span> opt</span></code></div><div class="spec-doc"><p>Options for the tool</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tool_name"><a href="#val-tool_name" class="anchor"></a><code><span><span class="keyword">val</span> tool_name : string</span></code></div><div class="spec-doc"><p>The name of the tool</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-toml_schema"><a href="#val-toml_schema" class="anchor"></a><code><span><span class="keyword">val</span> toml_schema : <span><a href="#type-opt">opt</a> <a href="../../../Eztoml/index.html#type-schema">Eztoml.schema</a></span></span></code></div><div class="spec-doc"><p>Tool options, retrieved from project configuration</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-default_opt"><a href="#val-default_opt" class="anchor"></a><code><span><span class="keyword">val</span> default_opt : <a href="#type-opt">opt</a></span></code></div><div class="spec-doc"><p>A default option value</p></div></div></details></div><div class="odoc-spec"><div class="spec module anchored" id="module-TestRepr"><a href="#module-TestRepr" class="anchor"></a><code><span><span class="keyword">module</span> <a href="TestRepr/index.html">TestRepr</a></span><span> : <a href="../../../Ctypes_bridge/Struct/module-type-REPR/index.html">Ctypes_bridge.Struct.REPR</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-input_data"><a href="#type-input_data" class="anchor"></a><code><span><span class="keyword">type</span> input_data</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-working_data"><a href="#type-working_data" class="anchor"></a><code><span><span class="keyword">type</span> working_data</span></code></div></div></details></div><div class="odoc-spec"><div class="spec type anchored" id="type-raw_input"><a href="#type-raw_input" class="anchor"></a><code><span><span class="keyword">type</span> raw_input</span><span> = <a href="TestRepr/Val/index.html#type-t">TestRepr.Val.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-initialize"><a href="#val-initialize" class="anchor"></a><code><span><span class="keyword">val</span> initialize : 
  <span><a href="#type-input_data">input_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span><a href="../../../Types/Label/index.html#type-any">Types.Label.any</a> <a href="../../../Types/Label/index.html#type-t">Types.Label.t</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-working_data">working_data</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>initialize proof_objectives file</code> initializes the runtime database and returns one working file for each function of <code>file</code> that is to be tested. <code>proof_objectives</code> must include all objectives associated with <code>infile</code>, whatever their status (unknown, covered, uncoverable).</p><p>TODO: It's a map from tested functions to proof objectives that we may need here.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-print_tested_fun"><a href="#val-print_tested_fun" class="anchor"></a><code><span><span class="keyword">val</span> print_tested_fun : <span><a href="#type-working_data">working_data</a> <a href="../../../../../seacoral-basics/Basics/PPrt/index.html#type-pp">Basics.PPrt.pp</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-typdecls"><a href="#val-typdecls" class="anchor"></a><code><span><span class="keyword">val</span> typdecls : <span><a href="#type-working_data">working_data</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../Ctypes_bridge/index.html#type-typdecls">Ctypes_bridge.typdecls</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-inputs_struct"><a href="#val-inputs_struct" class="anchor"></a><code><span><span class="keyword">val</span> inputs_struct : <span><a href="#type-working_data">working_data</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../Ctypes_bridge/Struct/index.html#type-typ">Ctypes_bridge.Struct.typ</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-label_data"><a href="#val-label_data" class="anchor"></a><code><span><span class="keyword">val</span> label_data : <span><a href="#type-working_data">working_data</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../Types/index.html#type-label_data">Types.label_data</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tested_fun_repr"><a href="#val-tested_fun_repr" class="anchor"></a><code><span><span class="keyword">val</span> tested_fun_repr : <span><a href="#type-working_data">working_data</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../Cil_utils/index.html#type-func_repr">Cil_utils.func_repr</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-tested_fun"><a href="#val-tested_fun" class="anchor"></a><code><span><span class="keyword">val</span> tested_fun : <span><a href="#type-working_data">working_data</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cil"><a href="#val-cil" class="anchor"></a><code><span><span class="keyword">val</span> cil : <span><a href="#type-working_data">working_data</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Cil</span>.file</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-runtime_data"><a href="#type-runtime_data" class="anchor"></a><code><span><span class="keyword">type</span> runtime_data</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-start"><a href="#val-start" class="anchor"></a><code><span><span class="keyword">val</span> start : <span><a href="#type-working_data">working_data</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-runtime_data">runtime_data</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>start file</code> returns a database of inputs and a share-able memory array for measuring coverage of the function/file identified by <code>file</code>.</p><p>TODO: this may deserve an option to force nullifying the db?</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-input_data_file"><a href="#val-input_data_file" class="anchor"></a><code><span><span class="keyword">val</span> input_data_file : <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-input_data">input_data</a></span></code></div><div class="spec-doc"><p><code>input_data_file rdb</code> provides the input file used to construct <code>rdb</code> (via <code>for_proof_objectives</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-read_input"><a href="#val-read_input" class="anchor"></a><code><span><span class="keyword">val</span> read_input : 
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../../../../seacoral-sys/Sc_sys/File/TYPES/index.html#type-file">Sc_sys.File.TYPES.file</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-raw_input">raw_input</a> option</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>read_input rdb f</code> reads an input value from file <code>f</code>; returns <code>None</code> if <code>f</code> does not contain a valid input.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-write_input"><a href="#val-write_input" class="anchor"></a><code><span><span class="keyword">val</span> write_input : <span><span><span class="type-var">'a</span> <a href="../../../../../seacoral-sys/Sc_sys/File/TYPES/index.html#type-file">Sc_sys.File.TYPES.file</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-raw_input">raw_input</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>write_input f v</code> promises to write the input value <code>v</code> into the file named <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-existing_input_ids"><a href="#val-existing_input_ids" class="anchor"></a><code><span><span class="keyword">val</span> existing_input_ids : 
  <span><span class="optlabel">?exclude</span>:<a href="../../../../../seacoral-basics/Basics/Digests/index.html#type-t">Basics.Digests.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../../seacoral-basics/Basics/Digests/index.html#type-t">Basics.Digests.t</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>existing_input_ids ~exclude rdb</code> is a stream of all identifiers of inputs previously registered into <code>rdb</code>. Members of <code>exclude</code>, if given, are ignored.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-existing_inputs"><a href="#val-existing_inputs" class="anchor"></a><code><span><span class="keyword">val</span> existing_inputs : 
  <span><span class="optlabel">?exclude</span>:<a href="../../../../../seacoral-basics/Basics/Digests/index.html#type-t">Basics.Digests.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-raw_input">raw_input</a> <a href="../../../Types/index.html#type-result_view">Types.result_view</a></span> <span class="xref-unresolved">Lwt_stream</span>.t</span></span></code></div><div class="spec-doc"><p><code>existing_inputs ~exclude rdb</code> is a stream of all inputs previously registered into <code>rdb</code>. Inputs whose digest belongs to <code>exclude</code>, if given, are ignored.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-share_input"><a href="#val-share_input" class="anchor"></a><code><span><span class="keyword">val</span> share_input : 
  <span><span class="optlabel">?on_share</span>:<span>(<span><span class="xref-unresolved">Stdlib</span>.Digest.t <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">toolname</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-raw_input">raw_input</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Stdlib</span>.Digest.t <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>share_input ~on_share ~toolname rdb v</code> promises to share a given input with value <code>v</code>, generated by a tool named <code>toolname</code>, in <code>rdb</code>. If provided, <code>on_share</code> is called immediately with the identifier computed from <code>v</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-share_status"><a href="#val-share_status" class="anchor"></a><code><span><span class="keyword">val</span> share_status : 
  <span><span class="label">toolname</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Cov <span>| `Uncov</span> <span>| `Unk</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../../seacoral-basics/Basics/Ints/index.html#type-t">Basics.Ints.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>share_status ~toolname rdb status label_ids</code> shares a set of <code>status</code> facts for the set of labels identified in <code>label_ids</code>. Those are registered as reported by the tool named <code>toolname</code>. May raise <code>Invalid_argument</code> if an identifier in <code>label_ids</code> does not correspond to a valid label, or <a href="../../../Exceptions/index.html#exception-ProofInconsistency"><code>Exceptions.ProofInconsistency</code></a> if at least one new status contradicts already known results.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-on_new_input"><a href="#val-on_new_input" class="anchor"></a><code><span><span class="keyword">val</span> on_new_input : 
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span><a href="#type-raw_input">raw_input</a> <a href="../../../Types/index.html#type-result_view">Types.result_view</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>on_new_input rdb f</code> promises to call <code>f</code> with the identifier and value of any <i>new</i> input that is given to <code>rdb</code> (e.g, via <a href="#val-share_input"><code>share_input</code></a>). The promised/returned function must be called at most once to terminate the registration of <code>f</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-on_termination"><a href="#val-on_termination" class="anchor"></a><code><span><span class="keyword">val</span> on_termination : 
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">h</span>:<span>(<span><span>[&gt; `Done <span>| `Stop</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>on_termination rdb ~h</code> registers a handler <code>h</code> that is called with argument <code>`Done</code> when all the objectives have been satisfied, or else with <code>`Stop</code> when the whole process stops. <code>on_termination</code> promises (returns) a function that can be used to cancel the registration.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-stop_receiving_inputs"><a href="#val-stop_receiving_inputs" class="anchor"></a><code><span><span class="keyword">val</span> stop_receiving_inputs : <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>stop_receiving_inputs rdb</code> returns a promise that is fulfilled whenever every input previously shared in <code>rdb</code> has been received and registered.</p><p>TODO: specify what happens if <a href="#val-share_input"><code>share_input</code></a> is called afterwards.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-for_compiled_subprocess"><a href="#val-for_compiled_subprocess" class="anchor"></a><code><span><span class="keyword">val</span> for_compiled_subprocess : 
  <span><span class="optlabel">?ld_preload_var</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../Types/index.html#type-compiled_subprocess_info">Types.compiled_subprocess_info</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>for_compiled_subprocess rdb</code> promises runtime information required for spanwed processed to access the shared coverage database.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_one_bypassed_input"><a href="#val-register_one_bypassed_input" class="anchor"></a><code><span><span class="keyword">val</span> register_one_bypassed_input : <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>register_bypassed_input rdb</code> registers an additional test input whose coverage has been accounted for in the status store, but that is not inserted into the database.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-covinfo"><a href="#val-covinfo" class="anchor"></a><code><span><span class="keyword">val</span> covinfo : <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../Types/index.html#type-covinfo">Types.covinfo</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>covinfo rdb</code> returns some statistics about coverage as measured via the memory array shared to spawned processes.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generate_test_files"><a href="#val-generate_test_files" class="anchor"></a><code><span><span class="keyword">val</span> generate_test_files : 
  <span><span class="label">exclude</span>:<a href="../../../../../seacoral-basics/Basics/Digests/index.html#type-t">Basics.Digests.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-runtime_data">runtime_data</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Generates the test files corresponding to the registered database tests.</p></div></div></div></body></html>
